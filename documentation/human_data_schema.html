<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5. Human Data Schema</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; margin-bottom: 1.5rem; }
        th, td { border: 1px solid #e2e8f0; padding: 0.75rem 1rem; text-align: left; vertical-align: top; }
        th { background-color: #f8fafc; font-weight: 600; }
        pre { background-color: #f1f5f9; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-top: 1rem; margin-bottom: 1rem; }
        code { font-family: 'Courier New', Courier, monospace; }
        .prose h1 { font-size: 2.25rem; font-weight: 700; margin-bottom: 1.5rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h2 { font-size: 1.875rem; font-weight: 600; margin-top: 2.5rem; margin-bottom: 1rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h3 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose p, .prose ul { margin-bottom: 1.25rem; line-height: 1.75; }
        .prose ul { list-style-type: disc; padding-left: 1.5rem; }
        .prose a { color: #2563eb; text-decoration: none; font-weight: 500; }
        .prose a:hover { text-decoration: underline; }
        .prose code { background-color: #f1f5f9; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-size: 0.9em; }
        .sidebar { width: 250px; position: fixed; left: 0; top: 0; height: 100vh; overflow-y: auto; background-color: #1f2937; }
        .content-wrapper { margin-left: 250px; }
        .nav-link { display: block; padding: 0.75rem 1.5rem; color: #d1d5db; text-decoration: none; border-left: 3px solid transparent; }
        .nav-link:hover { background-color: #374151; color: white; }
        .nav-link.active { background-color: #374151; color: white; border-left-color: #3b82f6; font-weight: 600; }
        .nav-section { position: relative; }
        .nav-section-header { display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
        .nav-section-header:hover { background-color: #374151; }
        .nav-expand-icon { transition: transform 0.2s; font-size: 0.75rem; margin-right: 0.5rem; }
        .nav-expand-icon.expanded { transform: rotate(90deg); }
        .nav-subsections { display: none; background-color: #111827; }
        .nav-subsections.expanded { display: block; }
        .nav-subsection-link { display: block; padding: 0.5rem 1.5rem 0.5rem 2.5rem; color: #9ca3af; text-decoration: none; font-size: 0.875rem; border-left: 3px solid transparent; }
        .nav-subsection-link:hover { background-color: #374151; color: white; }
        .nav-subsection-link.active { background-color: #374151; color: white; border-left-color: #3b82f6; }
        .nav-subsection { position: relative; }
        .nav-subsection-header { display: flex; align-items: center; justify-content: space-between; cursor: pointer; padding: 0.5rem 1.5rem 0.5rem 2.5rem; color: #9ca3af; font-size: 0.875rem; border-left: 3px solid transparent; }
        .nav-subsection-header:hover { background-color: #374151; color: white; }
        .nav-subsection-header.active { background-color: #374151; color: white; border-left-color: #3b82f6; }
        .nav-subsection-subsections { display: none; background-color: #0f172a; }
        .nav-subsection-subsections.expanded { display: block; }
        .nav-subsection-subsections .nav-subsection-link { padding-left: 3.5rem; }
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .content-wrapper { margin-left: 0; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 antialiased">

    <nav class="sidebar">
        <div class="py-4">
            <a href="index.html" class="nav-link">1. Overview</a>
            <a href="config_schema.html" class="nav-link">2. Config Schema (config.json)</a>
            <a href="trial_schema.html" class="nav-link">3. Trial Schema (trial.jsonl)</a>
            <a href="instruction_schema.html" class="nav-link">4. Instruction Schema</a>
            <div class="nav-section">
                <div class="nav-section-header nav-link active" onclick="toggleNavSection(this)">
                    <span>5. Human Data Schema</span>
                    <span class="nav-expand-icon expanded">â–¶</span>
                </div>
                <div class="nav-subsections expanded">
                    <a href="#individual-data" class="nav-subsection-link">5.1. Individual Data</a>
                    <a href="#mean-data" class="nav-subsection-link">5.2. Mean Data</a>
                </div>
            </div>
            <a href="appendix.html" class="nav-link">Appendix</a>
        </div>
    </nav>
    <script>
        function toggleNavSection(header) {
            const section = header.parentElement;
            const subsections = section.querySelector('.nav-subsections, .nav-subsection-subsections');
            const icon = header.querySelector('.nav-expand-icon');
            
            if (subsections && subsections.classList.contains('expanded')) {
                subsections.classList.remove('expanded');
                if (icon) icon.classList.remove('expanded');
            } else if (subsections) {
                subsections.classList.add('expanded');
                if (icon) icon.classList.add('expanded');
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const hash = window.location.hash;
            if (hash) {
                const target = document.querySelector(hash);
                if (target) {
                    const subsectionLink = document.querySelector(`a[href="${hash}"]`);
                    if (subsectionLink) {
                        subsectionLink.classList.add('active');
                        // Expand all parent sections if collapsed
                        let current = subsectionLink;
                        while (current) {
                            const subsection = current.closest('.nav-subsection');
                            const section = current.closest('.nav-section');
                            
                            if (subsection) {
                                const subsections = subsection.querySelector('.nav-subsection-subsections');
                                const icon = subsection.querySelector('.nav-expand-icon');
                                if (subsections && !subsections.classList.contains('expanded')) {
                                    subsections.classList.add('expanded');
                                    if (icon) icon.classList.add('expanded');
                                }
                                current = subsection;
                            } else if (section) {
                                const subsections = section.querySelector('.nav-subsections');
                                const icon = section.querySelector('.nav-expand-icon');
                                if (subsections && !subsections.classList.contains('expanded')) {
                                    subsections.classList.add('expanded');
                                    if (icon) icon.classList.add('expanded');
                                }
                                break;
                            } else {
                                break;
                            }
                        }
                    }
                }
            }
        });
    </script>

    <div class="content-wrapper">
    <div class="container mx-auto max-w-4xl p-6 md:p-12 bg-white shadow-lg rounded-lg my-12 prose prose-lg">

        <h1>5. File Specification: Human Data</h1>
        <p>This document outlines the required format for storing anonymized human subject data. The data is split into two files: one for individual participant data (<code>human_data_ind.json</code>) and one for mean/aggregated data (<code>human_data_mean.json</code>).</p>
        <p>Both files must include two summary metadata fields at the root:</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr><th>Key</th><th>Type</th><th>Description</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>participants_info</code></td>
                        <td>Dictionary</td>
                        <td>Demographic summary: requires <code>count</code> (Integer), <code>age</code> (Number; mean age or range), and <code>gender</code> (Dictionary with category counts). Additional fields allowed (e.g., education, geography).</td>
                    </tr>
                    <tr>
                        <td><code>judgment_count</code></td>
                        <td>Integer</td>
                        <td>Total number of human ratings in this file (sum of lengths across all response arrays).</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <section id="individual-data">
            <h2>5.1. <code>human_data_ind.json</code> (Individual Data)</h2>
            <p>This file contains the raw, anonymized responses for all participants, compiled by trial and question. The root of the JSON is an object where each key is a <code>stimuli_id</code>.</p>

            <h3>5.1.1. Stimulus Data Object Structure</h3>
            <p>Each <code>stimuli_id</code> object contains keys that <strong>must match the <code>tag</code>s</strong> defined in the trial's queries (see <a href="trial_schema.html#queries">Section 3.2</a>). The value for each tag is an array, where each item in the array is the response from a single participant.</p>
            <p>For example, if there were 4 participants, each response array will contain 4 elements.</p>

            <h3>5.1.2. Response Array Structure</h3>
            <p>The data type inside each participant's response array depends on the query <code>type</code> defined in <code>trial.jsonl</code>:</p>
            <ul>
                <li><strong><code>single-slider</code>:</strong> Array of Numbers (if <code>num_clicks</code> is 1 or not specified). If <code>num_clicks</code> > 1, then Array of Arrays of Numbers (each inner array contains N values from one participant).<br>e.g., <code>"goal_confidence": [95, 88, 70, 92]</code> (single click) or <code>"confidence_ratings": [[65, 72, 68], [80, 75, 78]]</code> (multi-click with num_clicks=3)</li>
                <li><strong><code>multi-choice</code>:</strong> Array of Objects.<br>e.g., <code>"agent_goal": [ { "idx": 0, "option_text": "Reaching the red box" }, { "idx": 1, "option_text": "Reaching the blue box" }, ... ]</code></li>
                <li><strong><code>multi-slider</code>:</strong> Array containing a single Object. The object's keys are the slider labels (from the <code>option</code> array in <code>trial.jsonl</code>), and its values are Arrays of Numbers (each array contains the response from all participants for that one slider).<br>e.g., <code>"statement_rating": [ { "Statement 1": [80, 75], "Statement 2": [25, 30] } ]</code></li>
                <li><strong><code>multi-select</code>:</strong> Array of Arrays of Integers. Each inner array is a one-hot encoding (0 or 1) of the participant's selections, corresponding to the <code>option</code> array in <code>trial.jsonl</code>.<br>e.g., <code>"cities_visited": [ [0, 1, 1, 0], [1, 0, 0, 0] ]</code></li>
                <li><strong><code>textbox</code>:</strong> Array of Strings.<br>e.g., <code>"strategy_description": [ "The agent seemed...", "It was trying to...", "I think it wanted...", ... ]</code></li>
                <li><strong><code>ranking</code>:</strong> Array of Arrays of Objects. Each inner array contains the ranked items for one participant, with each object including <code>idx</code>, <code>option_text</code>, and <code>rank</code>.<br>e.g., <code>"goal_ranking": [ [ { "idx": 2, "option_text": "Reaching the exit", "rank": 1 }, { "idx": 0, "option_text": "Finding the key", "rank": 2 } ], [ ... ] ]</code></li>
            </ul>
            
            <h3>5.1.3. Example: <code>human_data_ind.json</code></h3>
            <p>This example corresponds to the query tags defined in the <a href="trial_schema.html">Trial Schema</a> examples, assuming data from 2 participants. The keys <code>"trial_1_1"</code>, <code>"agent_goal"</code>, <code>"goal_confidence"</code>, <code>"statement_rating"</code>, and <code>"strategy_description"</code> are all defined in the <code>trial.jsonl</code> file.</p>
            <pre><code>{
  "participants_info": {
    "count": 104,
    "age": 35.27,
    "gender": { "male": 33, "female": 69, "other": 2 }
  },
  "judgment_count": 11886,
  "trial_1_1": {
    "agent_goal": [
      { "idx": 0, "option_text": "Reach the red box" },
      { "idx": 1, "option_text": "Reach the blue box" }
    ],
    "goal_confidence": [95, 88],
    "statement_rating": [
      { "Statement 1": [80, 75], "Statement 2": [25, 30] }
    ],
    "strategy_description": [
      "The agent seemed to favor the red box.",
      "It hesitated before choosing the blue box."
    ]
  },
  "trial_1_2": {
    "agent_goal": [
      { "idx": 2, "option_text": "Stay near the center" },
      { "idx": 0, "option_text": "Reach the red box" }
    ],
    "goal_confidence": [70, 82]
  }
}</code></pre>
        </section>

        <section id="mean-data">
            <h2>5.2. <code>human_data_mean.json</code> (Mean Data)</h2>
            <p>This file provides a convenient summary of the data, aggregated across all participants. The structure mirrors <code>human_data_ind.json</code>, but replaces the arrays of individual responses with aggregated statistics.</p>
            
            <h3>5.2.1. Structure</h3>
            <p>The structure for each <code>stimuli_id</code> will vary depending on the data type, but generally follows these principles:</p>
            <ul>
                <li><strong><code>single-slider</code> Data (e.g., <code>goal_confidence</code>):</strong> A single Number representing the <code>"mean"</code> of the numbers in the <code>ind</code> array.</li>
                <li><strong><code>multi-choice</code> Data (e.g., <code>agent_goal</code>):</strong> An object where keys are constructed from the <code>tag</code> and the option's 1-based index (e.g., <code>tag_1</code>, <code>tag_2</code>), and values are the counts or proportions.</li>
                <li><strong><code>multi-slider</code> Data (e.g., <code>statement_rating</code>):</strong> An object where keys are constructed from the <code>tag</code> and the option's 1-based index (e.g., <code>tag_1</code>, <code>tag_2</code>), and each value is a single Number representing the <code>"mean"</code>.</li>
                <li><strong><code>textbox</code> or <code>multi-select</code> Data:</strong> Aggregations are optional and task-specific (e.g., keyword counts, selection frequencies).</li>
            </ul>

            <h3>5.2.2. Example: <code>human_data_mean.json</code></h3>
            <p>This example shows the aggregated data for the <code>human_data_ind.json</code> example above. The keys are derived from the <code>tag</code>s in <code>trial.jsonl</code> (e.g., <code>agent_goal</code> becomes <code>agent_goal_1</code>, <code>agent_goal_2</code>; <code>statement_rating</code> becomes <code>statement_rating_1</code>, <code>statement_rating_2</code>).</p>
            <pre><code>{
  "participants_info": {
    "count": 104,
    "age": 35.27,
    "gender": { "male": 33, "female": 69, "other": 2 }
  },
  "judgment_count": 11886,
  "trial_1_1": {
    "agent_goal": {
      "agent_goal_1": 0.5,
      "agent_goal_2": 0.5
    },
    "goal_confidence": 91.5,
    "statement_rating": {
      "statement_rating_1": 77.5,
      "statement_rating_2": 27.5
    }
  },
  "trial_1_2": {
    "agent_goal": {
      "agent_goal_1": 0.5,
      "agent_goal_3": 0.5
    },
    "goal_confidence": 76.0
  }
}</code></pre>
        </section>

    </div>
    </div>

</body>
</html>

